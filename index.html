<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Abella Joias</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

<style>
body{background:#faf9f7}
.font-serif{font-family:'Cinzel',serif}
.gold{color:#A68966}
</style>
</head>

<body>

<header class="bg-white border-b p-6 text-center">
  <h1 class="font-serif text-2xl tracking-widest gold">Abella Joias</h1>
  <p class="text-xs tracking-widest text-gray-400 uppercase">Cat√°logo Oficial</p>
</header>

<!-- CATEGORIAS -->
<section class="max-w-6xl mx-auto px-4 py-6">
  <div id="filtroCategorias" class="flex gap-3 flex-wrap justify-center"></div>
</section>

<!-- PRODUTOS -->
<section class="max-w-6xl mx-auto px-4 pb-16">
  <div id="listaProdutos" class="grid grid-cols-2 md:grid-cols-4 gap-6"></div>
</section>

<script>
/* üî• FIREBASE ‚Äî CONFIGURA√á√ÉO REAL DA ABELLA */
firebase.initializeApp({
  apiKey: "AIzaSyDPBZSxW8XjtQmDMUknzAyIlFda51MvMJY",
  authDomain: "catalogo-abella-joias.firebaseapp.com",
  databaseURL: "https://catalogo-abella-joias-default-rtdb.firebaseio.com",
  projectId: "catalogo-abella-joias",
  storageBucket: "catalogo-abella-joias.firebasestorage.app",
  messagingSenderId: "727568435294",
  appId: "1:727568435294:web:442c0179ecf0686dff4ccf"
});

const db = firebase.database();

const listaProdutos = document.getElementById('listaProdutos');
const filtroCategorias = document.getElementById('filtroCategorias');

let produtos = [];
let categoriaAtiva = 'Todos';

/* üîπ CARREGAR CATEGORIAS */
db.ref('categories').on('value', snap => {
  filtroCategorias.innerHTML = '';

  const btnTodos = document.createElement('button');
  btnTodos.textContent = 'Todos';
  btnTodos.className = 'px-4 py-2 border text-xs';
  btnTodos.onclick = () => {
    categoriaAtiva = 'Todos';
    renderProdutos();
  };
  filtroCategorias.appendChild(btnTodos);

  snap.forEach(s => {
    const cat = s.val().name;

    const btn = document.createElement('button');
    btn.textContent = cat;
    btn.className = 'px-4 py-2 border text-xs';
    btn.onclick = () => {
      categoriaAtiva = cat;
      renderProdutos();
    };

    filtroCategorias.appendChild(btn);
  });
});

/* üîπ CARREGAR PRODUTOS */
db.ref('products').on('value', snap => {
  produtos = [];
  snap.forEach(s => {
    produtos.push({ id:s.key, ...s.val() });
  });
  renderProdutos();
});

/* üîπ RENDERIZAR PRODUTOS */
function renderProdutos(){
  listaProdutos.innerHTML = '';

  produtos
    .filter(p => categoriaAtiva === 'Todos' || p.category === categoriaAtiva)
    .forEach(p => {
      listaProdutos.innerHTML += `
        <div class="bg-white border hover:shadow-lg transition">
          <img src="${p.image}" class="w-full aspect-square object-cover">
          <div class="p-3 space-y-1">
            <p class="text-sm font-medium">${p.name}</p>
            <p class="text-xs text-gray-400">${p.category || ''}</p>
            <p class="gold font-semibold">R$ ${p.price.toFixed(2)}</p>
          </div>
        </div>
      `;
    });
}
</script>

</body>
</html>
