<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel Premium | Abella Joias</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
<style>
body{background:#F8F6F2}
.font-serif{font-family:'Cinzel',serif}
.gold{color:#A68966}
.tab{display:none}.tab.active{display:block}
.status-Novo{background:#FEF3C7}
.status-Separação{background:#E0F2FE}
.status-Enviado{background:#EDE9FE}
.status-Finalizado{background:#ECFDF5}
.card {transition:all .3s; border-radius:12px; overflow:hidden;}
.card:hover{transform:translateY(-3px); box-shadow:0 6px 20px rgba(0,0,0,0.1)}
</style>
</head>
<body class="font-sans">

<header class="bg-white border-b px-10 py-6 flex justify-between items-center">
  <div>
    <h1 class="font-serif text-xl gold tracking-widest">ABELLA JOIAS</h1>
    <p class="text-xs tracking-widest text-gray-400 uppercase">Painel Administrativo Premium</p>
  </div>
  <nav class="flex gap-4 text-xs tracking-widest uppercase">
    <button onclick="openTab('empresa')" class="gold">Empresa</button>
    <button onclick="openTab('categorias')">Categorias</button>
    <button onclick="openTab('produtos')">Produtos</button>
    <button onclick="openTab('galvanicas')">Galvânicas</button>
    <button onclick="openTab('pedidos')">Pedidos</button>
  </nav>
</header>

<main class="max-w-6xl mx-auto p-8 space-y-12">

<!-- EMPRESA -->
<section id="empresa" class="tab active space-y-6">
<h2 class="font-serif text-2xl gold border-b pb-2">Empresa</h2>
<div class="bg-white border p-6 grid md:grid-cols-2 gap-4">
  <input id="empNome" placeholder="Nome da empresa" class="border p-3">
  <input id="empWhatsapp" placeholder="WhatsApp" class="border p-3">
  <input id="empPix" type="number" placeholder="Desconto PIX (%)" class="border p-3">
  <input id="empParcelas" placeholder="Parcelas cartão (ex: 3x sem juros)" class="border p-3">
</div>
<button onclick="salvarEmpresa()" class="bg-black text-white px-8 py-3 text-xs">SALVAR EMPRESA</button>
</section>

<!-- CATEGORIAS -->
<section id="categorias" class="tab space-y-6">
<h2 class="font-serif text-2xl gold border-b pb-2">Categorias</h2>
<div class="bg-white border p-6 flex gap-4">
  <input id="catNome" placeholder="Nome da categoria" class="border p-3 flex-1">
  <button onclick="salvarCategoria()" class="bg-black text-white px-6 text-xs">ADICIONAR</button>
</div>
<div id="listaCategorias" class="space-y-2"></div>
</section>

<!-- PRODUTOS -->
<section id="produtos" class="tab space-y-8">
<h2 class="font-serif text-2xl gold border-b pb-2">Produtos</h2>
<div class="bg-white border p-6 grid md:grid-cols-2 gap-4">
  <input id="pNome" placeholder="Nome do produto" class="border p-3">
  <input id="pSku" placeholder="SKU" class="border p-3">
  <input id="pPreco" type="number" placeholder="Preço" class="border p-3">
  <input id="pPeso" type="number" placeholder="Peso (g)" class="border p-3">
  <select id="pCategoria" class="border p-3"><option value="">Selecione</option></select>
  <input type="file" id="pImagem" class="border p-3 md:col-span-2">
</div>
<button onclick="salvarProduto()" id="btnProduto" class="bg-black text-white px-8 py-3 text-xs">SALVAR PRODUTO</button>
<div id="listaProdutos" class="grid sm:grid-cols-2 gap-6 mt-6"></div>
</section>

<!-- GALVÂNICAS -->
<section id="galvanicas" class="tab space-y-8">
<h2 class="font-serif text-2xl gold border-b pb-2">Galvânicas Parceiras</h2>
<form id="formGalvanica" class="bg-white border p-6 grid gap-4">
  <input type="text" id="gNome" placeholder="Nome" class="border p-3" required>
  <input type="text" id="gEndereco" placeholder="Endereço" class="border p-3" required>
  <input type="text" id="gTelefone" placeholder="Telefone" class="border p-3" required>
  <input type="url" id="gWhatsapp" placeholder="Link WhatsApp" class="border p-3" required>
  <textarea id="gDescricao" placeholder="Descrição" class="border p-3" rows="3"></textarea>
  <input type="file" id="gLogo" accept="image/*" class="border p-3">
  <button type="submit" class="bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700">Salvar Galvânica</button>
</form>
<div id="listaGalvanicas" class="space-y-2"></div>
</section>

<!-- PEDIDOS -->
<section id="pedidos" class="tab space-y-6">
<h2 class="font-serif text-2xl gold border-b pb-2">Pedidos</h2>
<div class="flex gap-4 mb-4">
  <button onclick="filtrarPedidos('Todos')" class="bg-gray-200 px-3 py-1 rounded">Todos</button>
  <button onclick="filtrarPedidos('Novo')" class="bg-yellow-100 px-3 py-1 rounded">Novo</button>
  <button onclick="filtrarPedidos('Separação')" class="bg-blue-100 px-3 py-1 rounded">Separação</button>
  <button onclick="filtrarPedidos('Enviado')" class="bg-purple-100 px-3 py-1 rounded">Enviado</button>
  <button onclick="filtrarPedidos('Finalizado')" class="bg-green-100 px-3 py-1 rounded">Finalizado</button>
</div>
<div id="listaPedidos" class="space-y-4"></div>
</section>

</main>

<script>
/* ===== FIREBASE ===== */
firebase.initializeApp({
  apiKey: "AIzaSyDPBZSxW8XjtQmDMUknzAyIlFda51MvMJY",
  authDomain: "catalogo-abella-joias.firebaseapp.com",
  databaseURL: "https://catalogo-abella-joias-default-rtdb.firebaseio.com",
  projectId: "catalogo-abella-joias",
  storageBucket: "catalogo-abella-joias.appspot.com"
});
const db=firebase.database();
const storage=firebase.storage();

/* ===== TABS ===== */
function openTab(id){document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.getElementById(id).classList.add('active');}

/* ===== EMPRESA ===== */
function salvarEmpresa(){
 db.ref('settings').set({name:empNome.value,whatsapp:empWhatsapp.value,pix:Number(empPix.value||0),parcelas:empParcelas.value});
 alert('Empresa salva');
}
db.ref('settings').on('value',s=>{if(!s.val())return;empNome.value=s.val().name||'';empWhatsapp.value=s.val().whatsapp||'';empPix.value=s.val().pix||0;empParcelas.value=s.val().parcelas||'';});

/* ===== CATEGORIAS ===== */
function salvarCategoria(){if(!catNome.value)return;db.ref('categories').push({name:catNome.value});catNome.value='';}
db.ref('categories').on('value',snap=>{
 listaCategorias.innerHTML=''; pCategoria.innerHTML='<option value="">Selecione</option>';
 snap.forEach(s=>{
   listaCategorias.innerHTML+=`<div class="bg-white border p-3 flex justify-between items-center card">${s.val().name}<input type='file' onchange="trocarImagem('${s.key}',this.files[0])" class='border p-1 rounded'/><button onclick="db.ref('categories/${s.key}').remove()" class='text-red-600 px-2 py-1 text-xs'>Excluir</button></div>`;
   pCategoria.innerHTML+=`<option>${s.val().name}</option>`;
 });
});
function trocarImagem(id,file){const ref=storage.ref('categorias/'+file.name);ref.put(file).then(()=>{ref.getDownloadURL().then(url=>{db.ref('categories/'+id).update({image:url});alert('Imagem atualizada!');});});}

/* ===== PRODUTOS ===== */
let editando=null;
function salvarProduto(){
 const file=pImagem.files[0];
 const produto={name:pNome.value,sku:pSku.value,price:Number(pPreco.value),weight:Number(pPeso.value),category:pCategoria.value,image:''};
 if(file){const ref=storage.ref('products/'+file.name);ref.put(file).then(()=>{ref.getDownloadURL().then(url=>{produto.image=url;salvarProdutoDB(produto);});});}else{salvarProdutoDB(produto);}
}
function salvarProdutoDB(produto){if(editando){db.ref('products/'+editando).set(produto);editando=null;btnProduto.textContent='SALVAR PRODUTO';}else{db.ref('products').push(produto);}pNome.value=pSku.value=pPreco.value=pPeso.value='';pCategoria.value='';pImagem.value='';}
db.ref('products').on('value',snap=>{listaProdutos.innerHTML='';snap.forEach(s=>{const p=s.val();listaProdutos.innerHTML+=`<div class="bg-white border p-4 card"><img src="${p.image}" class="h-40 w-full object-cover"><p class="mt-2 font-semibold">${p.name}</p><p class="text-xs">${p.category} • ${p.weight}g</p><p class="gold font-semibold">R$ ${p.price.toFixed(2)}</p><div class="flex gap-2 mt-2 text-xs"><button onclick="editarProduto('${s.key}')" class="bg-blue-500 text-white px-2 py-1">Editar</button><button onclick="db.ref('products/${s.key}').remove()" class="bg-red-500 text-white px-2 py-1">Excluir</button></div></div>`;});});
function editarProduto(id){db.ref('products/'+id).once('value').then(s=>{const p=s.val();pNome.value=p.name;pSku.value=p.sku;pPreco.value=p.price;pPeso.value=p.weight;pCategoria.value=p.category;editando=id;btnProduto.textContent='ATUALIZAR PRODUTO';});}

/* ===== GALVÂNICAS ===== */
const formGalvanica=document.getElementById('formGalvanica');
formGalvanica.addEventListener('submit',e=>{
 e.preventDefault();
 const nome=gNome.value,endereco=gEndereco.value,telefone=gTelefone.value,whatsapp=gWhatsapp.value,descricao=gDescricao.value,logoFile=gLogo.files[0];
 if(logoFile){const ref=storage.ref('galvanicas/'+logoFile.name);ref.put(logoFile).then(()=>{ref.getDownloadURL().then(url=>{salvarGalvanica(nome,endereco,telefone,whatsapp,descricao,url);});});}else{salvarGalvanica(nome,endereco,telefone,whatsapp,descricao,'');}
});
function salvarGalvanica(nome,endereco,telefone,whatsapp,descricao,logo){const newGalv=db.ref('galvanicas').push();newGalv.set({nome,endereco,telefone,whatsapp,descricao,logo});alert('Galvânica cadastrada!');formGalvanica.reset();}
db.ref('galvanicas').on('value',snap=>{listaGalvanicas.innerHTML='';snap.forEach(s=>{const g=s.val(),id=s.key;listaGalvanicas.innerHTML+=`<div class="bg-white border p-4 flex justify-between items-center card"><div class="flex items-center gap-4"><img src="${g.logo||'https://via.placeholder.com/50'}" class="h-12 w-12 object-cover rounded border"><div><p class="font-semibold">${g.nome}</p><p class="text-xs">${g.endereco}</p><p class="text-xs">${g.telefone} • ${g.whatsapp}</p></div></div><button onclick="db.ref('galvanicas/${id}').remove()" class="text-red-600 px-2 py-1 text-xs">Excluir</button></div>`;});});

/* ===== PEDIDOS ===== */
let filtroPedidos='Todos';
function filtrarPedidos(status){filtroPedidos=status;renderPedidos();}
function renderPedidos(){db.ref('orders').once('value').then(snap=>{
 listaPedidos.innerHTML='';snap.forEach(s=>{const o=s.val(),id=s.key;if(filtroPedidos!='Todos' && o.status!=filtroPedidos)return;
 listaPedidos.innerHTML+=`<div class="bg-white border p-4 status-${o.status} card"><p class="font-semibold">${o.cliente}</p><p class="text-xs">${o.data}</p><p>${o.pagamento} • ${o.peso}g</p><strong>R$ ${o.total.toFixed(2)}</strong><div class="flex gap-2 mt-2 text-xs">${['Novo','Separação','Enviado','Finalizado'].map(st=>`<button onclick="db.ref('orders/${id}/status').set('${st}')" class="border px-2 py-1">${st}</button>`).join('')}<button onclick="imprimir(${JSON.stringify(o).replace(/"/g,'&quot;')})" class="bg-black text-white px-2 py-1">Romaneio</button><button onclick="db.ref('orders/${id}').remove()" class="text-red-600 px-2 py-1">Excluir</button></div></div>`;});});}
renderPedidos();
function imprimir(o){alert(`Romaneio Premium:\nCliente: ${o.cliente}\nStatus: ${o.status}`);}
</script>

</body>
</html>
