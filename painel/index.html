<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Admin â€¢ Abella Joias</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

<style>
body{background:#0b0b0b;color:#eee;font-family:Inter,Arial}
nav button.active{border-color:#caa85c;color:#caa85c}
section{display:none}
section.active{display:block}
.card{background:#141414;border:1px solid #2a2a2a;border-radius:16px;padding:14px}
input,select{background:#1a1a1a;border:1px solid #333;color:#fff;padding:8px;border-radius:8px;width:100%}
.btn{background:#caa85c;color:#000;font-weight:bold;padding:8px 12px;border-radius:8px;font-size:11px;text-transform:uppercase}
.btn-red{background:#ef4444;color:#fff}
</style>
</head>

<body>

<!-- NAV -->
<nav class="flex justify-around bg-[#111] p-4 border-b border-[#222] sticky top-0">
  <button class="active" onclick="showTab('pedidos',this)">Pedidos</button>
  <button onclick="showTab('produtos',this)">Produtos</button>
  <button onclick="showTab('categorias',this)">Categorias</button>
  <button onclick="abrirConfig()" class="text-[#caa85c]">Config</button>
</nav>

<main class="p-4 max-w-7xl mx-auto">

<!-- PEDIDOS -->
<section id="pedidos" class="active">
  <h2 class="mb-4 text-[#caa85c] font-bold text-xs uppercase">Pedidos</h2>
  <div id="listaPedidos" class="space-y-2"></div>
</section>

<!-- PRODUTOS -->
<section id="produtos">
  <div class="flex justify-between mb-4">
    <h2 class="text-[#caa85c] font-bold text-xs uppercase">Produtos</h2>
    <button class="btn" onclick="novoProduto()">+ Produto</button>
  </div>
  <div id="produtosPorCategoria"></div>
</section>

<!-- CATEGORIAS -->
<section id="categorias">
  <div class="flex justify-between mb-4">
    <h2 class="text-[#caa85c] font-bold text-xs uppercase">Categorias</h2>
    <button class="btn" onclick="novaCategoria()">+ Categoria</button>
  </div>
  <div id="listaCategorias" class="grid gap-3 md:grid-cols-4"></div>
</section>

</main>

<!-- MODAL -->
<div id="modal" class="fixed inset-0 bg-black/80 hidden items-center justify-center p-4">
  <div class="bg-[#141414] w-full max-w-md rounded-xl border border-[#333]">
    <div class="p-3 border-b flex justify-between">
      <span id="modalTitulo"></span>
      <button onclick="fecharModal()">âœ•</button>
    </div>
    <div id="modalBody" class="p-4"></div>
    <div class="p-3 text-right">
      <button id="modalSalvar" class="btn">Salvar</button>
    </div>
  </div>
</div>

<script>
/* ðŸ”¥ FIREBASE */
firebase.initializeApp({
  apiKey: "AIzaSyDPBZSxW8XjtQmDMUknzAyIlFda51MvMJY",
  databaseURL: "https://catalogo-abella-joias-default-rtdb.firebaseio.com"
});
const db = firebase.database();

/* ðŸ§© UI */
function showTab(id,btn){
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}

function abrirModal(titulo,html,cb){
  modal.style.display='flex';
  modalTitulo.innerText=titulo;
  modalBody.innerHTML=html;
  modalSalvar.onclick=cb;
}
function fecharModal(){modal.style.display='none';}

/* âš™ï¸ CONFIG */
function abrirConfig(){
  db.ref('settings/empresa').once('value',s=>{
    const v=s.val()||{};
    abrirModal('ConfiguraÃ§Ãµes',`
      <label>Nome</label><input id="cNome" value="${v.nome||''}">
      <label>Whats</label><input id="cWhats" value="${v.fone||''}">
    `,()=>{
      db.ref('settings/empresa').update({
        nome:cNome.value,
        fone:cWhats.value
      });
      fecharModal();
    });
  });
}

/* ðŸ“¦ CATEGORIAS */
function novaCategoria(){
  abrirModal('Nova Categoria',`
    <input id="catNome" placeholder="Nome da categoria">
  `,()=>{
    db.ref('categories').push({name:catNome.value});
    fecharModal();
  });
}

db.ref('categories').on('value',s=>{
  listaCategorias.innerHTML='';
  s.forEach(c=>{
    listaCategorias.innerHTML+=`
      <div class="card">
        <b>${c.val().name}</b>
      </div>`;
  });
});

/* ðŸ’Ž PRODUTOS */
function novoProduto(){
  db.ref('categories').once('value',s=>{
    let opts='';
    s.forEach(c=>opts+=`<option value="${c.key}">${c.val().name}</option>`);
    abrirModal('Novo Produto',`
      <input id="pNome" placeholder="Nome">
      <input id="pPreco" type="number" placeholder="PreÃ§o">
      <select id="pCat">${opts}</select>
      <input id="pImg" placeholder="Imagem URL">
    `,()=>{
      db.ref('products').push({
        name:pNome.value,
        price:+pPreco.value,
        category:pCat.value,
        image:pImg.value
      });
      fecharModal();
    });
  });
}

db.ref('products').on('value',s=>{
  produtosPorCategoria.innerHTML='';
  db.ref('categories').once('value',cats=>{
    cats.forEach(cat=>{
      let html=`<h3 class="mt-4 text-[#caa85c]">${cat.val().name}</h3><div class="grid md:grid-cols-4 gap-2">`;
      s.forEach(p=>{
        if(p.val().category===cat.key){
          html+=`<div class="card text-xs">${p.val().name}<br>R$ ${p.val().price}</div>`;
        }
      });
      html+='</div>';
      produtosPorCategoria.innerHTML+=html;
    });
  });
});

/* ðŸ§¾ PEDIDOS */
db.ref('orders').on('value',s=>{
  listaPedidos.innerHTML='';
  s.forEach(p=>{
    listaPedidos.innerHTML+=`
      <div class="card text-xs">
        <b>${p.val().cliente}</b><br>
        Total: ${p.val().total}
      </div>`;
  });
});
</script>
</body>
</html>
