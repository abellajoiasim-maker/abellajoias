<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Administrativo | Abella Joias</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>

<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

<style>
body{font-family:Poppins;background:#f8f6f2}
.serif{font-family:Cinzel}
.gold{color:#A68966}
.tab{display:none}
.tab.active{display:block}
.menu button{padding:14px 20px;text-align:left}
.menu button:hover{background:#f1eee8}
.image-1x1{aspect-ratio:1/1;object-fit:contain;background:white}
.card{background:white;border:1px solid #e5e5e5;border-radius:10px}
</style>
</head>

<body class="flex">

<!-- MENU -->
<aside class="w-64 bg-white border-r min-h-screen menu">
  <h1 class="serif text-xl gold p-6 border-b">Abella Joias</h1>
  <button onclick="openTab('empresa')">ğŸ¢ Empresa</button>
  <button onclick="openTab('categorias')">ğŸ“‚ Categorias</button>
  <button onclick="openTab('produtos')">ğŸ’ Produtos</button>
  <button onclick="openTab('galvanicas')">ğŸ­ GalvÃ¢nicas</button>
  <button onclick="openTab('pedidos')">ğŸ“¦ Pedidos</button>
</aside>

<main class="flex-1 p-8 space-y-16">

<!-- EMPRESA -->
<section id="empresa" class="tab active space-y-4">
<h2 class="serif text-2xl gold">Empresa</h2>
<div class="card p-6 grid md:grid-cols-2 gap-4">
<input id="empNome" placeholder="Nome da empresa" class="border p-3">
<input id="empWhats" placeholder="WhatsApp pedidos" class="border p-3">
<input id="empPix" type="number" placeholder="Desconto PIX %" class="border p-3">
<input id="empParcelas" type="number" placeholder="Parcelas cartÃ£o sem juros" class="border p-3">
</div>
<button onclick="salvarEmpresa()" class="bg-black text-white px-6 py-2">Salvar</button>
</section>

<!-- CATEGORIAS -->
<section id="categorias" class="tab space-y-4">
<h2 class="serif text-2xl gold">Categorias</h2>
<div class="card p-4 grid md:grid-cols-3 gap-3">
<input id="catNome" placeholder="Nome" class="border p-3">
<input id="catImg" placeholder="URL imagem" class="border p-3">
<button onclick="salvarCategoria()" class="bg-black text-white">Salvar</button>
</div>
<div id="listaCategorias" class="grid md:grid-cols-4 gap-4"></div>
</section>

<!-- PRODUTOS -->
<section id="produtos" class="tab space-y-4">
<h2 class="serif text-2xl gold">Produtos</h2>
<div class="card p-4 grid md:grid-cols-3 gap-3">
<input id="pNome" placeholder="Nome" class="border p-3">
<input id="pSku" placeholder="SKU" class="border p-3">
<input id="pPreco" type="number" step="0.01" placeholder="PreÃ§o cheio" class="border p-3">
<input id="pPromo" type="number" step="0.01" placeholder="Desconto promoÃ§Ã£o %" class="border p-3">
<input id="pPeso" type="number" step="0.01" placeholder="Peso (g)" class="border p-3">
<select id="pCategoria" class="border p-3">
  <option value="">Selecione a categoria</option>
</select>

  
<input id="pImg" placeholder="URL imagem" class="border p-3 md:col-span-3">
</div>
<button onclick="salvarProduto()" class="bg-black text-white px-6 py-2">Salvar produto</button>
<div id="listaProdutos" class="grid md:grid-cols-4 gap-4"></div>
</section>

<!-- GALVÃ‚NICAS -->
<section id="galvanicas" class="tab space-y-4">
<h2 class="serif text-2xl gold">GalvÃ¢nicas</h2>
<div class="card p-4 grid md:grid-cols-3 gap-3">
<input id="gNome" placeholder="Nome" class="border p-3">
<input id="gSelo" placeholder="Texto do selo" class="border p-3">
<input id="gImg" placeholder="Logo" class="border p-3">
<input id="gWhats" placeholder="WhatsApp" class="border p-3">
<textarea id="gDesc" placeholder="DescriÃ§Ã£o" class="border p-3 md:col-span-3"></textarea>
</div>
<button onclick="salvarGalvanica()" class="bg-black text-white px-6 py-2">Salvar galvÃ¢nica</button>
<div id="listaGalvanicas" class="grid md:grid-cols-3 gap-6"></div>
</section>

<!-- PEDIDOS -->
<section id="pedidos" class="tab space-y-4">
<h2 class="serif text-2xl gold">Pedidos</h2>
<div id="listaPedidos" class="space-y-4"></div>
</section>

</main>

<script>
firebase.initializeApp({
apiKey:"AIzaSyDPBZSxW8XjtQmDMUknzAyIlFda51MvMJY",
databaseURL:"https://catalogo-abella-joias-default-rtdb.firebaseio.com"
});
const db=firebase.database();

function openTab(id){
document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
document.getElementById(id).classList.add('active');
}

/* EMPRESA */
function salvarEmpresa(){
db.ref('empresa').set({
nome:empNome.value,
whats:empWhats.value,
pix:Number(empPix.value),
parcelas:Number(empParcelas.value)
});
}

/* CATEGORIAS */
function salvarCategoria(){
db.ref('categories').on('value', snap => {
  const select = document.getElementById('pCategoria');
  select.innerHTML = '<option value="">Selecione a categoria</option>';

  snap.forEach(s => {
    const c = s.val();
    select.innerHTML += `<option value="${c.name}">${c.name}</option>`;
  });
});


/* PRODUTOS */
function salvarProduto(){
  const produto = {
    nome: pNome.value,
    sku: pSku.value,
    preco: Number(pPreco.value) || 0,
    promo: Number(pPromo.value) || 0,
    peso: Number(pPeso.value) || 0,
    categoria: pCategoria.value, // âœ… CATEGORIA
    imagem: pImagemUrl.value,
    dataCadastro: new Date().toISOString()
  };

  if(produtoEdit){
    db.ref('products/' + produtoEdit).set(produto);
    produtoEdit = null;
  } else {
    db.ref('products').push(produto);
  }

  // limpar formulÃ¡rio
  pNome.value =
  pSku.value =
  pPreco.value =
  pPromo.value =
  pPeso.value =
  pCategoria.value =
  pImagemUrl.value = '';
}
  
function editarProduto(id){
  db.ref('products/' + id).once('value').then(s => {
    const p = s.val();

    pNome.value = p.nome;
    pSku.value = p.sku;
    pPreco.value = p.preco;
    pPromo.value = p.promo || 0;
    pPeso.value = p.peso || 0;
    pCategoria.value = p.categoria || '';
    pImagemUrl.value = p.imagem || '';

    produtoEdit = id;
    window.scrollTo(0,0);
  });
}


/* GALVÃ‚NICAS */
function salvarGalvanica(){
db.ref('galvanicas').push({
nome:gNome.value,
selo:gSelo.value,
img:gImg.value,
whats:gWhats.value,
desc:gDesc.value
});
}

/* PEDIDOS */
db.ref('pedidos').on('value',s=>{
listaPedidos.innerHTML='';
s.forEach(p=>{
listaPedidos.innerHTML+=`
<div class="card p-4 flex justify-between">
<div>
<p class="font-bold">${p.val().cliente}</p>
<p class="text-xs">R$ ${p.val().total}</p>
<select onchange="db.ref('pedidos/${p.key}/status').set(this.value)">
<option>Novo</option><option>Separado</option><option>Faturado</option>
</select>
</div>
<a href="romaneio.html?id=${p.key}" target="_blank" class="text-blue-600">ğŸ§¾ Gerar Romaneio</a>
</div>`;
});
});
</script>

</body>
</html>
